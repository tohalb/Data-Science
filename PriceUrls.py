# -*- coding: utf-8 -*-
"""
Created on Wed Nov 18 00:38:45 2015

@author: tomhales
"""

"""

from yahoo_finance import Share
from pprint import pprint

yahoo = Share('YHOO')
print yahoo.get_open()

print yahoo.get_price()

print yahoo.get_trade_datetime()

pprint (yahoo.get_historical('2014-04-25', '2014-04-29'))

"""
import urllib

tickerlist=[]
tickerlist = [
"0270.HK",
"0384.HK",
"0522.HK",
"0590.HK",
"0728.HK",
"0751.HK",
"0861.HK",
"0950.HK",
"1093.HK",
"1199.HK",
"1777.NG",
"1929.HK",
"1945.T",
"2155.T",
"2266.HK",
"2268.T",
"2388.HK",
"2397.T",
"2579.T",
"2599.T",
"2656.T",
"3053.T",
"3231.T",
"3331.HK",
"3420.T",
"3529.T",
"3778.T",
"3998.HK",
"3999.HK",
"4107.T",
"4283.T",
"4307.T",
"4462.T",
"4519.T",
"4549.T",
"4556.T",
"4684.T",
"4689.T",
"4793.T",
"4832.T",
"4929.T",
"4957.T",
"4973.T",
"5609.T",
"5857.T",
"5933.T",
"601919.SS",
"6111.NG",
"6210.T",
"6287.T",
"6305.T",
"6501.T",
"6506.T",
"6588.T",
"6594.T",
"6663.T",
"6676.T",
"6719.T",
"6722.T",
"6752.T",
"6755.T",
"6794.T",
"6798.T",
"6858.T",
"6860.T",
"6946.T",
"6954.T",
"6999.T",
"7211.T",
"7267.T",
"7268.T",
"7466.T",
"7477.T",
"7517.T",
"7558.T",
"7751.T",
"7931.NG",
"7976.T",
"8014.T",
"8036.T",
"8060.T",
"8076.NG",
"8249.T",
"8566.T",
"8586.T",
"8604.T",
"8703.T",
"8707.T",
"8783.T",
"8877.T",
"8898.T",
"9022.T",
"9039.T",
"9086.T",
"9368.T",
"9532.T",
"9621.T",
"9640.T",
"9680.T",
"9708.T",
"9922.T",
"9950.T",
"AA",
"AA.N",
"AAL.L",
"AAL.OQ",
"AAPL.O",
"AAPL.OQ",
"ABBV.N",
"ABF.L",
"ABGL.L",
"ABT.N",
"ACN.N",
"ADBE.OQ",
"ADML.L",
"ADN.L",
"AEMN.SI",
"AEO.N",
"AER.L",
"AERL.I",
"AFRE.L",
"AGGK.L",
"AHGP.OQ",
"AHT.L",
"AIG.N",
"AIR.N",
"AIRF.PA",
"ALAPH.L",
"ALL.AX",
"ALOG.OQ",
"ALQ.AX",
"AMAT.O",
"AMAT.OQ",
"AMD.OQ",
"AMGN.OQ",
"AMTD.N",
"AMZG.A",
"AMZN.O",
"AMZN.OQ",
"AN.N",
"ANF",
"ANF.N",
"ANTO.L",
"ANZ.AX",
"AO.L",
"AOL.N",
"AON",
"AON.N",
"API.AX",
"ARLP.OQ",
"ARM.L",
"ASHM.L",
"ASOS.L",
"ASPU.OB",
"ASRT.SI",
"AST.AX",
"AV.L",
"AVV.L",
"AXP",
"AXP.N",
"AZN.L",
"AZO.N",
"BA",
"BA.N",
"BAB.L",
"BAC",
"BAC.N",
"BALF.L",
"BARC.L",
"BATS.L",
"BAYGn.DE",
"BBT",
"BBT.N",
"BBY",
"BBY.N",
"BDEV.L",
"BETF.L",
"BG.L",
"BHP.AX",
"BID.N",
"BIOS.SI",
"BK",
"BK.N",
"BKGH.L",
"BKL.AX",
"BKW.N",
"BLK",
"BLK.N",
"BLND.L",
"BLPU.L",
"BLT.L",
"BNPP.PA",
"BNZL.L",
"BP.L",
"BRBY.L",
"BRSN.L",
"BRW.L",
"BSY.L",
"BT.L",
"BTT.AX",
"BVIC.L",
"BVS.L",
"BWNG.L",
"BWY.L",
"BXB.AX",
"C",
"C.N",
"CACT.SI",
"CAG.N",
"CAN",
"CAT",
"CAT.N",
"CATL.SI",
"CATVU.L",
"CBA.AX",
"CCC.L",
"CCC.N",
"CCE",
"CDBG.DE",
"CHKE.OQ",
"CINE.L",
"CIU.L",
"CL",
"CLDN.L",
"CLLN.L",
"CMA",
"CME.OQ",
"CNA.L",
"CNE.L",
"CNSI.OQ",
"CO.N",
"COB.L",
"COF",
"COF.N",
"COLT.L",
"COP",
"COP.N",
"COSC.SI",
"COST.O",
"COST.OQ",
"CPG.L",
"CPI.L",
"CPW.L",
"CRM.N",
"CSCO.O",
"CSCO.OQ",
"CSR.AX",
"CSR.L",
"CSRT.L",
"CSX",
"CSX.N",
"CTAS.OQ",
"CTDM.SI",
"CTXS.OQ",
"CVX",
"CVX.N",
"CWC.L",
"CWD.L",
"DAIN.MX",
"DAL",
"DAL.N",
"DB1Gn.DE",
"DBKGn.DE",
"DBSM.SI",
"DC.L",
"DE.N",
"DEB.L",
"DECP.L",
"DG.N",
"DGE.L",
"DIS",
"DLAR.L",
"DLG.DE",
"DLGD.L",
"DLX.AX",
"DMGOa.L",
"DNLM.L",
"DOM.L",
"DOPR.L",
"DOW.N",
"DPLM.L",
"DRNG.F",
"DRX.L",
"DSC.L",
"DXNS.L",
"EBAY.O",
"EBAY.OQ",
"EMG.L",
"ENRC.L",
"ETFC.O",
"ETFC.OQ",
"ETOF.PA",
"EVRE.L",
"EXPE.O",
"EXPN.L",
"EXPR.N",
"EZHL.SI",
"EZJ.L",
"F",
"F.N",
"FB.O",
"FB.OQ",
"FCCN.L",
"FCRT.SI",
"FDL.L",
"FDSA.L",
"FDX",
"FDX.N",
"FE",
"FE.N",
"FENR.L",
"FGP.L",
"FHN.N",
"FINL.OQ",
"FITB.O",
"FITB.OQ",
"FOXT.L",
"FRES.L",
"FRNM.SI",
"FSAM.OQ",
"FSC.OQ",
"FSFR.OQ",
"FXPO.L",
"GAGR.SI",
"GE",
"GE.N",
"GENS.SI",
"GES.N",
"GFS.L",
"GIS",
"GKN.L",
"GLPL.SI",
"GLVT.SI",
"GM",
"GNC.AX",
"GNDP.PA",
"GNK.L",
"GOG.L",
"GOOG.O",
"GOOGL.O",
"GOOGL.OQ",
"GPS",
"GPS.N",
"GRG.L",
"GRPN.OQ",
"GS",
"GS.L",
"GS.N",
"GSK.L",
"HAL.N",
"HAYS.L",
"HBA_pf.N",
"HD",
"HD.N",
"HDG",
"HFD.L",
"HFG.L",
"HGGH.L",
"HLT.N",
"HMSO.L",
"HOCM.L",
"HOG",
"HOG.N",
"HOME.L",
"HPHT.SI",
"HPQ",
"HRB.N",
"HRGV.L",
"HSBA.L",
"HSV.L",
"HSX.L",
"IAP.L",
"IBM",
"IBM.N",
"IFAR.SI",
"IHG.L",
"III.L",
"IMG.L",
"IMT.L",
"INCH.L",
"INF.L",
"INTC.L",
"INTC.O",
"INTC.OQ",
"INVP.L",
"IOC.N",
"IPF.L",
"IPL.AX",
"IPN.PA",
"IRV.L",
"ISA.L",
"ISYS.L",
"ITV.L",
"IVZ",
"JCYC.SI",
"JD.L",
"JDW.L",
"JHX.N",
"JINS.OL",
"JMAT.L",
"JNJ",
"JNJ.N",
"JPM",
"JPM.N",
"K",
"K.N",
"KAZ.L",
"KEY",
"KEY.N",
"KGF.L",
"KIE.L",
"KKD.N",
"KLAN.SI",
"KLR.L",
"KMX.N",
"KO",
"KORS.N",
"KPLM.SI",
"KR",
"KR.N",
"L.N",
"LAD.L",
"LAM.L",
"LAND.L",
"LEI.AX",
"LGEN.L",
"LHAG.DE",
"LLOY.L",
"LMI.L",
"LNKD.N",
"LRD.L",
"LSE.L",
"LUV",
"LUV.N",
"M.N",
"MA",
"MA.N",
"MAB.L",
"MANG.DE",
"MANU.N",
"MARS.L",
"MCB.L",
"MCD",
"MCD.N",
"MCS.N",
"MEC.L",
"MGGT.L",
"MHCC.PK",
"MILL.N",
"MKS.L",
"MLC.L",
"MON.N",
"MONY.L",
"MPI.L",
"MQG.AX",
"MRK.N",
"MRO.N",
"MRW.L",
"MS",
"MS.N",
"MSFT",
"MSFT.O",
"MSFT.OQ",
"MSI",
"MSI.N",
"MTC.L",
"MTS.AX",
"MU.OQ",
"MUL.L",
"NAB.AX",
"NDAQ.O",
"NEPS.SI",
"NEX.L",
"NEXI.PA",
"NFLX.O",
"NFLX.OQ",
"NG.L",
"NKE",
"NKE.N",
"NTRS.OQ",
"NWY.N",
"NXT.L",
"NYT.N",
"OCDO.L",
"OGC.AX",
"OKSB.OQ",
"OLAM.SI",
"OML.L",
"ORCL.N",
"ORI.AX",
"OVTI.OQ",
"OXM.N",
"PAY.N",
"PAYP.L",
"PAYX.OQ",
"PDN.AX",
"PEE",
"PEFO.SI",
"PEP",
"PETM.O",
"PETM.OQ",
"PETSP.L",
"PFC.L",
"PFD.L",
"PFE",
"PFE.N",
"PG",
"PLND.L",
"PMO.L",
"PNN.L",
"POG.L",
"POM.N",
"PRU",
"PRU.L",
"PSMT.OQ",
"PSN.L",
"PSON.L",
"PSX",
"PUB.L",
"QCOM.OQ",
"RAAG.DE",
"RAT.L",
"RB.L",
"RBS.L",
"REL.L",
"RENA.PA",
"REX.L",
"RGU.L",
"RIO.L",
"RL",
"RMG.L",
"RNK.L",
"RPC.L",
"RPS.L",
"RR.L",
"RRS.L",
"RSA.L",
"RSL.L",
"RSW.L",
"RTN.L",
"RTO.L",
"RWA.L",
"RYA.L",
"SAB.L",
"SASY.PA",
"SBRY.L",
"SBUX.O",
"SBUX.OQ",
"SCHN.PA",
"SCHW",
"SCHW.N",
"SCIL.SI",
"SDR.L",
"SEVI.PA",
"SGC.L",
"SGE.L",
"SGP.L",
"SGRO.L",
"SGXL.SI",
"SHB.L",
"SHP.L",
"SHW.N",
"SIA.L",
"SIAL.SI",
"SJP.L",
"SL.L",
"SLB",
"SLB.N",
"SMWH.L",
"SN.L",
"SNDK.O",
"SNR.L",
"SONC.OQ",
"SPD.L",
"SPLS.O",
"SPLS.OQ",
"SPOS.SI",
"SPRTC.L",
"SPT.L",
"SRP.L",
"SSE.L",
"SSW.N",
"STAN.L",
"STAR.SI",
"STEL.SI",
"STF.PA",
"STHR.L",
"STI",
"STOB.L",
"STT.N",
"STTS.SI",
"STZ",
"STZ.N",
"SUNT.SI",
"SVI.L",
"SVT.L",
"SW1.DE",
"SWN",
"SWY",
"SXS.L",
"SYY.N",
"T",
"T.N",
"TAT.SI",
"TATE.L",
"TCG.L",
"TED.L",
"TESO.OQ",
"TIF",
"TIF.N",
"TIME.N",
"TLPR.L",
"TLW.L",
"TMUS.N",
"TNE.AX",
"TNI.L",
"TOTF.PA",
"TPK.L",
"TPT.L",
"TRI.TO",
"TRIP.OQ",
"TSCO.L",
"TSN.N",
"TT.L",
"TTC.N",
"TTP.L",
"TW.L",
"TWC",
"TWC.N",
"TWTR.N",
"TWX.N",
"TXN.O",
"ULVR.L",
"UNP.N",
"UOBH.SI",
"UPS",
"USB.N",
"UTG.L",
"UTX",
"UU.L",
"V",
"V.N",
"VCTX.L",
"VED.L",
"VENM.SI",
"VIAB.OQ",
"VOD.L",
"VOWG_p.DE",
"VSVS.L",
"VZ",
"VZ.N",
"WAG",
"WAG.N",
"WBC.AX",
"WEIR.L",
"WES.AX",
"WFC",
"WFC.N",
"WFM.OQ",
"WG.L",
"WGO.N",
"WHM.L",
"WHR",
"WHR.N",
"WLIL.SI",
"WMH.L",
"WMT",
"WMT.N",
"WOS.L",
"WOW.AX",
"WPP.L",
"WTB.L",
"WU",
"X",
"X.N",
"XOM",
"XOM.N",
"XPP.L",
"XRX.N",
"YHOO.O",
"YHOO.OQ",
"YUM",
"ZQK.N"
]

directory =""
content = ""
base_url = "https://uk.finance.yahoo.com/q/hp?s="
def make_url(ticker_symbol):
    return base_url + ticker_symbol

#output_path = "/Documents/pythonex/prices"
output_path = "/Users/tomhales/Documents/pythonex/prices/"
def make_filename(ticker_symbol, directory=""):
    return output_path + "" + directory + "/" + ticker_symbol + ".csv"

def pull_historical_data(ticker_symbol, directory=""):
    try:
        urllib.urlretrieve(make_url(ticker_symbol), make_filename(ticker_symbol, directory))
    except urllib.ContentTooShortError as e:
        outfile = open(make_filename(ticker_symbol, directory), "w")
        outfile.write(e.content)
        outfile.close()


make_filename("PriceURLs")
#try:
#    urllib.urlretrieve(make_url("PriceURLs"), make_filename("PriceURLs", directory))
#except urllib.ContentTooShortError as e:
outfile = open(make_filename("PriceURLs", directory), "w")
for ticker_symbol in tickerlist:
    content = base_url + ticker_symbol
    outfile.write(content)
    outfile.write("\n")
outfile.close()
        
        
#    pull_historical_data(ticker_symbol)